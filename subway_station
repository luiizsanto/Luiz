Problems new york subway

1º search for the problems on the internet

Problems:
- ageing infraestruture
- delays: 70.000 delays every month in 2017; 28.000 per month on 2012
- accessibility: wheelchair, elevators, ramp, stairs
- safety and security: crime in the transit system is up by more than 40%
- funding and budget
- inproved signal controls: fixed-block signealing
- car types: A, B, special, modular, opne
- automated arrival announcements
- safety 
- spacious plataform
- 4g wifi on subway stations
- maintenance: art work, deteriorating, walls, etc
- autopay
- parking
- pollution: such as the continual griding of the train wheels against the rails, the eletricity collecting shoes,
and diesel soot emissions from maintenance locomotives are important shources
-numbers: 472 stations and 665 miles of track 
-evercrowding
-bus connectivety 

Questions:

What arte the number of delays per month (latest year)?
What type of car are more prone to breakdown?
what stations have wheelschair acces and elevators?
Whats is the passengers capacity of each train?

------------------------------------------------------------------------------------------------------------
antepenúltimo vídeo

# --1--
#get a simple time diferrence 

select 
  arrival_time,
  departure_time,
  time_diff(departure_time, arrival_time, minute) as t_diff1
from(
select
  time "23:30:00" as arrival_time,
  time "23:35:00" as departure_time,
)
;

# --2--
select 
  arrival_time,
  departure_time,
  time_diff(cast(departure_time as time), cast(arrival_time as time), minute) as t_diff1
from(
  select *
  from `bigquery-public-data.new_york_subway.stop_times`
  #where regexp_contains(arrival)
  LIMIT 10
)
;
------------------------------------------------------------------------------------------------------------
penúltimo vídeo

Join tables: stop_times, trips and routes

select count(distinct trip_id)
from `bigquery-public-data.new_york_subway.trips`

Resultado: 19640 #number of trip IDs




